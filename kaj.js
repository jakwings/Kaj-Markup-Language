(function e$$0(j,f,c){function g(d,a){if(!f[d]){if(!j[d]){var e="function"==typeof require&&require;if(!a&&e)return e(d,!0);if(b)return b(d,!0);e=Error("Cannot find module '"+d+"'");throw e.code="MODULE_NOT_FOUND",e;}e=f[d]={exports:{}};j[d][0].call(e.exports,function(a){var c=j[d][1][a];return g(c?c:a)},e,e.exports,e$$0,j,f,c)}return f[d].exports}for(var b="function"==typeof require&&require,e=0;e<c.length;e++)g(c[e]);return g})({1:[function(h,j,f){function c(a,p,b){if(!(this instanceof c))return new c(a,
p,b);var d=typeof a,e;if("number"===d)e=0<a?a>>>0:0;else if("string"===d){if("base64"===p)for(a=(a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")).replace(C,"");0!==a.length%4;)a+="=";e=c.byteLength(a,p)}else if("object"===d&&null!==a)"Buffer"===a.type&&k(a.data)&&(a=a.data),e=0<+a.length?Math.floor(+a.length):0;else throw new TypeError("must start with number, buffer, array or string");if(this.length>B)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+B.toString(16)+" bytes");
var g;c.TYPED_ARRAY_SUPPORT?g=c._augment(new Uint8Array(e)):(g=this,g.length=e,g._isBuffer=!0);if(c.TYPED_ARRAY_SUPPORT&&"number"===typeof a.byteLength)g._set(a);else if(k(a)||c.isBuffer(a)||a&&"object"===typeof a&&"number"===typeof a.length)if(c.isBuffer(a))for(p=0;p<e;p++)g[p]=a.readUInt8(p);else for(p=0;p<e;p++)g[p]=(a[p]%256+256)%256;else if("string"===d)g.write(a,0,p);else if("number"===d&&!c.TYPED_ARRAY_SUPPORT&&!b)for(p=0;p<e;p++)g[p]=0;return g}function g(a,p,c,d){for(var b=[],e=0;e<p.length;e++)b.push(p.charCodeAt(e)&
255);return v(b,a,c,d)}function b(a,p,c){var d="";for(c=Math.min(a.length,c);p<c;p++)d+=String.fromCharCode(a[p]);return d}function e(a,p,c){if(0!==a%1||0>a)throw new RangeError("offset is not uint");if(a+p>c)throw new RangeError("Trying to access beyond buffer length");}function d(a,p,d,b,e,g){if(!c.isBuffer(a))throw new TypeError("buffer must be a Buffer instance");if(p>e||p<g)throw new TypeError("value is out of bounds");if(d+b>a.length)throw new TypeError("index out of range");}function a(a,p,
c,d){0>p&&(p=65535+p+1);for(var b=0,e=Math.min(a.length-c,2);b<e;b++)a[c+b]=(p&255<<8*(d?b:1-b))>>>8*(d?b:1-b)}function m(a,p,c,b){0>p&&(p=4294967295+p+1);for(var d=0,e=Math.min(a.length-c,4);d<e;d++)a[c+d]=p>>>8*(b?d:3-d)&255}function r(a,p,c,d,b,e){if(p>b||p<e)throw new TypeError("value is out of bounds");if(c+d>a.length)throw new TypeError("index out of range");}function l(a,p,c,d,b){b||r(a,p,c,4,3.4028234663852886E38,-3.4028234663852886E38);A.write(a,p,c,d,23,4);return c+4}function t(a,c,d,b,
e){e||r(a,c,d,8,1.7976931348623157E308,-1.7976931348623157E308);A.write(a,c,d,b,52,8);return d+8}function x(a){for(var c=[],d=0;d<a.length;d++){var b=a.charCodeAt(d);if(127>=b)c.push(b);else{var e=d;55296<=b&&57343>=b&&d++;b=encodeURIComponent(a.slice(e,d+1)).substr(1).split("%");for(e=0;e<b.length;e++)c.push(parseInt(b[e],16))}}return c}function v(a,c,d,b){for(var e=0;e<b&&!(e+d>=c.length||e>=a.length);e++)c[e+d]=a[e];return e}function u(a){try{return decodeURIComponent(a)}catch(c){return String.fromCharCode(65533)}}
var z=h("base64-js"),A=h("ieee754"),k=h("is-array");f.Buffer=c;f.SlowBuffer=c;f.INSPECT_MAX_BYTES=50;c.poolSize=8192;var B=1073741823;h=c;var w;try{var n=new ArrayBuffer(0),s=new Uint8Array(n);s.foo=function(){return 42};w=42===s.foo()&&"function"===typeof s.subarray&&0===(new Uint8Array(1)).subarray(1,1).byteLength}catch(y){w=!1}h.TYPED_ARRAY_SUPPORT=w;c.isBuffer=function(a){return!!(null!=a&&a._isBuffer)};c.compare=function(a,d){if(!c.isBuffer(a)||!c.isBuffer(d))throw new TypeError("Arguments must be Buffers");
for(var b=a.length,e=d.length,g=0,f=Math.min(b,e);g<f&&a[g]===d[g];g++);g!==f&&(b=a[g],e=d[g]);return b<e?-1:e<b?1:0};c.isEncoding=function(a){switch(String(a).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "binary":case "base64":case "raw":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};c.concat=function(a,d){if(!k(a))throw new TypeError("Usage: Buffer.concat(list[, length])");if(0===a.length)return new c(0);if(1===a.length)return a[0];var b;
if(void 0===d)for(b=d=0;b<a.length;b++)d+=a[b].length;var e=new c(d),g=0;for(b=0;b<a.length;b++){var f=a[b];f.copy(e,g);g+=f.length}return e};c.byteLength=function(a,c){var d;a+="";switch(c||"utf8"){case "ascii":case "binary":case "raw":d=a.length;break;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":d=2*a.length;break;case "hex":d=a.length>>>1;break;case "utf8":case "utf-8":d=x(a).length;break;case "base64":d=z.toByteArray(a).length;break;default:d=a.length}return d};c.prototype.length=void 0;
c.prototype.parent=void 0;c.prototype.toString=function(a,d,c){var e=!1;d>>>=0;c=void 0===c||Infinity===c?this.length:c>>>0;a||(a="utf8");0>d&&(d=0);c>this.length&&(c=this.length);if(c<=d)return"";for(;;)switch(a){case "hex":a=d;d=this.length;if(!a||0>a)a=0;if(!c||0>c||c>d)c=d;for(d="";a<c;a++)d+=16>this[a]?"0"+this[a].toString(16):this[a].toString(16);return d;case "utf8":case "utf-8":a=d;e=d="";for(c=Math.min(this.length,c);a<c;a++)127>=this[a]?(d+=u(e)+String.fromCharCode(this[a]),e=""):e+="%"+
this[a].toString(16);return d+u(e);case "ascii":return b(this,d,c);case "binary":return b(this,d,c);case "base64":return a=d,c=0===a&&c===this.length?z.fromByteArray(this):z.fromByteArray(this.slice(a,c)),c;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":c=this.slice(d,c);a="";for(d=0;d<c.length;d+=2)a+=String.fromCharCode(c[d]+256*c[d+1]);return a;default:if(e)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase();e=!0}};c.prototype.equals=function(a){if(!c.isBuffer(a))throw new TypeError("Argument must be a Buffer");
return 0===c.compare(this,a)};c.prototype.inspect=function(){var a="",d=f.INSPECT_MAX_BYTES;0<this.length&&(a=this.toString("hex",0,d).match(/.{2}/g).join(" "),this.length>d&&(a+=" ... "));return"<Buffer "+a+">"};c.prototype.compare=function(a){if(!c.isBuffer(a))throw new TypeError("Argument must be a Buffer");return c.compare(this,a)};c.prototype.get=function(a){console.log(".get() is deprecated. Access using array indexes instead.");return this.readUInt8(a)};c.prototype.set=function(a,d){console.log(".set() is deprecated. Access using array indexes instead.");
return this.writeUInt8(a,d)};c.prototype.write=function(a,d,c,b){if(isFinite(d))isFinite(c)||(b=c,c=void 0);else{var e=b;b=d;d=c;c=e}d=Number(d)||0;e=this.length-d;c?(c=Number(c),c>e&&(c=e)):c=e;b=String(b||"utf8").toLowerCase();switch(b){case "hex":b=c;d=Number(d)||0;c=this.length-d;b?(b=Number(b),b>c&&(b=c)):b=c;c=a.length;if(0!==c%2)throw Error("Invalid hex string");b>c/2&&(b=c/2);for(c=0;c<b;c++){e=parseInt(a.substr(2*c,2),16);if(isNaN(e))throw Error("Invalid hex string");this[d+c]=e}a=c;break;
case "utf8":case "utf-8":a=v(x(a),this,d,c);break;case "ascii":a=g(this,a,d,c);break;case "binary":a=g(this,a,d,c);break;case "base64":a=v(z.toByteArray(a),this,d,c);break;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":b=d;d=c;for(var f,e=[],m=0;m<a.length;m++)f=a.charCodeAt(m),c=f>>8,f%=256,e.push(f),e.push(c);a=v(e,this,b,d);break;default:throw new TypeError("Unknown encoding: "+b);}return a};c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||
this,0)}};c.prototype.slice=function(a,d){var b=this.length;a=~~a;d=void 0===d?b:~~d;0>a?(a+=b,0>a&&(a=0)):a>b&&(a=b);0>d?(d+=b,0>d&&(d=0)):d>b&&(d=b);d<a&&(d=a);if(c.TYPED_ARRAY_SUPPORT)return c._augment(this.subarray(a,d));for(var b=d-a,e=new c(b,void 0,!0),g=0;g<b;g++)e[g]=this[g+a];return e};c.prototype.readUInt8=function(a,d){d||e(a,1,this.length);return this[a]};c.prototype.readUInt16LE=function(a,d){d||e(a,2,this.length);return this[a]|this[a+1]<<8};c.prototype.readUInt16BE=function(a,d){d||
e(a,2,this.length);return this[a]<<8|this[a+1]};c.prototype.readUInt32LE=function(a,d){d||e(a,4,this.length);return(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]};c.prototype.readUInt32BE=function(a,d){d||e(a,4,this.length);return 16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])};c.prototype.readInt8=function(a,d){d||e(a,1,this.length);return!(this[a]&128)?this[a]:-1*(255-this[a]+1)};c.prototype.readInt16LE=function(a,d){d||e(a,2,this.length);var c=this[a]|this[a+1]<<8;return c&32768?
c|4294901760:c};c.prototype.readInt16BE=function(a,d){d||e(a,2,this.length);var c=this[a+1]|this[a]<<8;return c&32768?c|4294901760:c};c.prototype.readInt32LE=function(a,d){d||e(a,4,this.length);return this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24};c.prototype.readInt32BE=function(a,d){d||e(a,4,this.length);return this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]};c.prototype.readFloatLE=function(a,d){d||e(a,4,this.length);return A.read(this,a,!0,23,4)};c.prototype.readFloatBE=function(a,d){d||e(a,
4,this.length);return A.read(this,a,!1,23,4)};c.prototype.readDoubleLE=function(a,d){d||e(a,8,this.length);return A.read(this,a,!0,52,8)};c.prototype.readDoubleBE=function(a,d){d||e(a,8,this.length);return A.read(this,a,!1,52,8)};c.prototype.writeUInt8=function(a,b,e){a=+a;b>>>=0;e||d(this,a,b,1,255,0);c.TYPED_ARRAY_SUPPORT||(a=Math.floor(a));this[b]=a;return b+1};c.prototype.writeUInt16LE=function(b,e,g){b=+b;e>>>=0;g||d(this,b,e,2,65535,0);c.TYPED_ARRAY_SUPPORT?(this[e]=b,this[e+1]=b>>>8):a(this,
b,e,!0);return e+2};c.prototype.writeUInt16BE=function(b,e,g){b=+b;e>>>=0;g||d(this,b,e,2,65535,0);c.TYPED_ARRAY_SUPPORT?(this[e]=b>>>8,this[e+1]=b):a(this,b,e,!1);return e+2};c.prototype.writeUInt32LE=function(a,b,e){a=+a;b>>>=0;e||d(this,a,b,4,4294967295,0);c.TYPED_ARRAY_SUPPORT?(this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=a):m(this,a,b,!0);return b+4};c.prototype.writeUInt32BE=function(a,b,e){a=+a;b>>>=0;e||d(this,a,b,4,4294967295,0);c.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=
a>>>16,this[b+2]=a>>>8,this[b+3]=a):m(this,a,b,!1);return b+4};c.prototype.writeInt8=function(a,b,e){a=+a;b>>>=0;e||d(this,a,b,1,127,-128);c.TYPED_ARRAY_SUPPORT||(a=Math.floor(a));0>a&&(a=255+a+1);this[b]=a;return b+1};c.prototype.writeInt16LE=function(b,e,g){b=+b;e>>>=0;g||d(this,b,e,2,32767,-32768);c.TYPED_ARRAY_SUPPORT?(this[e]=b,this[e+1]=b>>>8):a(this,b,e,!0);return e+2};c.prototype.writeInt16BE=function(b,e,g){b=+b;e>>>=0;g||d(this,b,e,2,32767,-32768);c.TYPED_ARRAY_SUPPORT?(this[e]=b>>>8,this[e+
1]=b):a(this,b,e,!1);return e+2};c.prototype.writeInt32LE=function(a,b,e){a=+a;b>>>=0;e||d(this,a,b,4,2147483647,-2147483648);c.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24):m(this,a,b,!0);return b+4};c.prototype.writeInt32BE=function(a,b,e){a=+a;b>>>=0;e||d(this,a,b,4,2147483647,-2147483648);0>a&&(a=4294967295+a+1);c.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=a):m(this,a,b,!1);return b+4};c.prototype.writeFloatLE=function(a,
b,d){return l(this,a,b,!0,d)};c.prototype.writeFloatBE=function(a,b,d){return l(this,a,b,!1,d)};c.prototype.writeDoubleLE=function(a,b,d){return t(this,a,b,!0,d)};c.prototype.writeDoubleBE=function(a,b,d){return t(this,a,b,!1,d)};c.prototype.copy=function(a,b,d,e){d||(d=0);!e&&0!==e&&(e=this.length);b||(b=0);if(e!==d&&!(0===a.length||0===this.length)){if(e<d)throw new TypeError("sourceEnd < sourceStart");if(0>b||b>=a.length)throw new TypeError("targetStart out of bounds");if(0>d||d>=this.length)throw new TypeError("sourceStart out of bounds");
if(0>e||e>this.length)throw new TypeError("sourceEnd out of bounds");e>this.length&&(e=this.length);a.length-b<e-d&&(e=a.length-b+d);e-=d;if(1E3>e||!c.TYPED_ARRAY_SUPPORT)for(var g=0;g<e;g++)a[g+b]=this[g+d];else a._set(this.subarray(d,d+e),b)}};c.prototype.fill=function(a,b,d){a||(a=0);b||(b=0);d||(d=this.length);if(d<b)throw new TypeError("end < start");if(d!==b&&0!==this.length){if(0>b||b>=this.length)throw new TypeError("start out of bounds");if(0>d||d>this.length)throw new TypeError("end out of bounds");
if("number"===typeof a)for(;b<d;b++)this[b]=a;else{a=x(a.toString());for(var c=a.length;b<d;b++)this[b]=a[b%c]}return this}};c.prototype.toArrayBuffer=function(){if("undefined"!==typeof Uint8Array){if(c.TYPED_ARRAY_SUPPORT)return(new c(this)).buffer;for(var a=new Uint8Array(this.length),b=0,d=a.length;b<d;b+=1)a[b]=this[b];return a.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser");};var q=c.prototype;c._augment=function(a){a.constructor=c;a._isBuffer=!0;a._get=a.get;
a._set=a.set;a.get=q.get;a.set=q.set;a.write=q.write;a.toString=q.toString;a.toLocaleString=q.toString;a.toJSON=q.toJSON;a.equals=q.equals;a.compare=q.compare;a.copy=q.copy;a.slice=q.slice;a.readUInt8=q.readUInt8;a.readUInt16LE=q.readUInt16LE;a.readUInt16BE=q.readUInt16BE;a.readUInt32LE=q.readUInt32LE;a.readUInt32BE=q.readUInt32BE;a.readInt8=q.readInt8;a.readInt16LE=q.readInt16LE;a.readInt16BE=q.readInt16BE;a.readInt32LE=q.readInt32LE;a.readInt32BE=q.readInt32BE;a.readFloatLE=q.readFloatLE;a.readFloatBE=
q.readFloatBE;a.readDoubleLE=q.readDoubleLE;a.readDoubleBE=q.readDoubleBE;a.writeUInt8=q.writeUInt8;a.writeUInt16LE=q.writeUInt16LE;a.writeUInt16BE=q.writeUInt16BE;a.writeUInt32LE=q.writeUInt32LE;a.writeUInt32BE=q.writeUInt32BE;a.writeInt8=q.writeInt8;a.writeInt16LE=q.writeInt16LE;a.writeInt16BE=q.writeInt16BE;a.writeInt32LE=q.writeInt32LE;a.writeInt32BE=q.writeInt32BE;a.writeFloatLE=q.writeFloatLE;a.writeFloatBE=q.writeFloatBE;a.writeDoubleLE=q.writeDoubleLE;a.writeDoubleBE=q.writeDoubleBE;a.fill=
q.fill;a.inspect=q.inspect;a.toArrayBuffer=q.toArrayBuffer;return a};var C=/[^+\/0-9A-z]/g},{"base64-js":2,ieee754:3,"is-array":4}],2:[function(h,j,f){h="undefined"===typeof f?this.base64js={}:f;var c=function(c){c=c.charCodeAt(0);if(c===b)return 62;if(c===e)return 63;if(c<d)return-1;if(c<d+10)return c-d+52;if(c<m+26)return c-m;if(c<a+26)return c-a+26},g="undefined"!==typeof Uint8Array?Uint8Array:Array,b=43,e=47,d=48,a=97,m=65;h.toByteArray=function(a){function b(a){h[j++]=a}var d,e,f,m,h;if(0<a.length%
4)throw Error("Invalid string. Length must be a multiple of 4");d=a.length;m="="===a.charAt(d-2)?2:"="===a.charAt(d-1)?1:0;h=new g(3*a.length/4-m);e=0<m?a.length-4:a.length;var j=0;for(d=0;d<e;d+=4)f=c(a.charAt(d))<<18|c(a.charAt(d+1))<<12|c(a.charAt(d+2))<<6|c(a.charAt(d+3)),b((f&16711680)>>16),b((f&65280)>>8),b(f&255);2===m?(f=c(a.charAt(d))<<2|c(a.charAt(d+1))>>4,b(f&255)):1===m&&(f=c(a.charAt(d))<<10|c(a.charAt(d+1))<<4|c(a.charAt(d+2))>>2,b(f>>8&255),b(f&255));return h};h.fromByteArray=function(a){var b,
d=a.length%3,c="",e,g;b=0;for(g=a.length-d;b<g;b+=3)e=(a[b]<<16)+(a[b+1]<<8)+a[b+2],c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>18&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>12&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>6&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e&63);switch(d){case 1:e=a[a.length-1];c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>
2);c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e<<4&63);c+="==";break;case 2:e=(a[a.length-2]<<8)+a[a.length-1],c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>10),c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>4&63),c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e<<2&63),c+="="}return c}},{}],3:[function(h,j,f){f.read=function(c,g,b,e,d){var a;a=8*d-e-1;var f=(1<<a)-1,r=
f>>1,l=-7;d=b?d-1:0;var t=b?-1:1,x=c[g+d];d+=t;b=x&(1<<-l)-1;x>>=-l;for(l+=a;0<l;b=256*b+c[g+d],d+=t,l-=8);a=b&(1<<-l)-1;b>>=-l;for(l+=e;0<l;a=256*a+c[g+d],d+=t,l-=8);if(0===b)b=1-r;else{if(b===f)return a?NaN:Infinity*(x?-1:1);a+=Math.pow(2,e);b-=r}return(x?-1:1)*a*Math.pow(2,b-e)};f.write=function(c,g,b,e,d,a){var f,r=8*a-d-1,l=(1<<r)-1,t=l>>1,x=23===d?Math.pow(2,-24)-Math.pow(2,-77):0;a=e?0:a-1;var v=e?1:-1,u=0>g||0===g&&0>1/g?1:0;g=Math.abs(g);if(isNaN(g)||Infinity===g)g=isNaN(g)?1:0,e=l;else{e=
Math.floor(Math.log(g)/Math.LN2);if(1>g*(f=Math.pow(2,-e)))e--,f*=2;g=1<=e+t?g+x/f:g+x*Math.pow(2,1-t);2<=g*f&&(e++,f/=2);e+t>=l?(g=0,e=l):1<=e+t?(g=(g*f-1)*Math.pow(2,d),e+=t):(g=g*Math.pow(2,t-1)*Math.pow(2,d),e=0)}for(;8<=d;c[b+a]=g&255,a+=v,g/=256,d-=8);e=e<<d|g;for(r+=d;0<r;c[b+a]=e&255,a+=v,e/=256,r-=8);c[b+a-v]|=128*u}},{}],4:[function(h,j){var f=Object.prototype.toString;j.exports=Array.isArray||function(c){return!!c&&"[object Array]"==f.call(c)}},{}],5:[function(h){var j=h("clone"),f=h("extend"),
c=h("./utils/roles.js"),g=h("./utils/directives.js"),b=h("./utils/class-renderer.js"),e=h("./utils/class-blocklexer.js"),d=h("./utils/class-inlinelexer.js");h=h("./utils/class-tnode.js");var a=function(d,c){var g=c?f(!0,j(a.options),c):a.options;return b.render(e.lex(d,g),g)};a.lex=function(b,d){var c=d?f(!0,j(a.options),d):a.options;return e.lex(b,c)};a.render=function(d,c){var e=c?f(!0,j(a.options),c):a.options;return b.render(d,e)};a.InlineLexer=d;a.BlockLexer=e;a.Renderer=b;a.Tnode=h;a.setDirective=
function(b,d,c){if(!d||/^[ \t\f\{]|[ \t\f]$/.test(d||""))throw Error("Directive name is invalid.");var e=typeof c;b=a.options.directives[b];"string"===e?b[d]=b[c]:"function"===e?b[d]=c:delete b[d]};a.setRole=function(b,d){if(!b||/^[ \t\f~]|[ \t\f~]$/.test(b||""))throw Error("Role name is invalid.");var c=typeof d;"string"===c?a.options.roles[b]=a.options.roles[d]:"function"===c?a.options.roles[b]=d:delete a.options.roles[b]};a.options={directives:g,roles:c,highlight:null,cwd:"./"};c=function(a){a.parentNode.remove(a)};
a.setDirective("immediate","@include",c);a.setDirective("immediate","@embed",c);window.kaj=a},{"./utils/class-blocklexer.js":6,"./utils/class-inlinelexer.js":7,"./utils/class-renderer.js":8,"./utils/class-tnode.js":9,"./utils/directives.js":10,"./utils/roles.js":12,clone:13,extend:14}],6:[function(h,j){var f=h("clone"),c=h("extend"),g=h("./helpers.js"),b=g.parseOptions,e=g.throwError,d=g.getIndent,a=g.trim,m=g.pad,r=h("./class-tnode.js"),l=function(a){var b=h("./class-inlinelexer.js"),d=h("./class-renderer.js");
this.options=a;this._inlineLexer=new b(a);this._helpers=c(f(g,!1),{clone:f,extend:c,options:this.options,blockLexer:this,inlineLexer:this._inlineLexer,Tnode:r,InlineLexer:b,BlockLexer:l,Renderer:d});this.lines=[];this.ast=new r({type:"_root_"},!0);this._markers={b_section:/^(==*)(.*)/,b_ul_item:/^([*+\-]) (.*)/,b_ol_item:/^#(\d\d*(?:\.\d\d*)*) (.*)/,b_lb_line:/^\|(?: (.*)|$)/,b_code:/^~\/\/([^ \t\f]*)(.*)/,b_oneliner:/^~\/ (.*)/,b_directive:/^\.\.(?: ([^ \t\f\{]+)\{([^{}]*)\}(.*)| (.*)|$)/,b_paragraph:null};
this._directives={};this._directiveQueues={before:[],after:[]};for(var e in a.directives){var b=a.directives[e],m;for(m in b)this.registerDirective(e,m,b[m])}(a=this.getDirective("#section"))&&this.scheduleDirective(a)};l.lex=function(a,b){return(new l(b)).lex(a)};l.prototype.lex=function(a){this.lines=a.split(/(?:\n|\r\n?)/);a=this.tokenize(this.ast,0,0);this.lines.splice(0,a);this.executeDirective("before");var b=this._inlineLexer;this.ast.traverse(function(a){/^(?:b_paragraph|b_lb_line|_fragment_)$/.test(a.type)&&
b.lex(a)});this.executeDirective("after");return this.ast};l.prototype.tokenize=function(b,c,g,f){for(var l=this.lines,h=this._markers,k,j=l.length;c<j;c++){var w=l[c],n=d(w);if(!1===n){if("i_text"!==f)continue}else if(n<g)break;else if(n>g&&"i_text"!==f)if(f)break;else{k=new r({type:"b_indented"},!0);k.parentNode=b;c=this.tokenize(k,c,n)-1;b.addNode(k);continue}w=w.substr(g);if("i_text"===f)b.addNode(new r({type:"i_text",text:w}));else{var s;a:for(s in h)switch(k=h[s],n=null,s){case "b_section":if(n=
k.exec(w)){var y=a(n[2]).replace(/ *==*$/,"");if(" "!==n[2][0]&&y)break;if(f&&s!==f)return c;n=n[1].length;if(y){if(b.type===s&&b.size>=n)return c;k=new r({type:s,size:n},!0);k.addNode(new r({type:"b_heading",size:n,text:y}));k.parentNode=b;c=this.tokenize(k,c+1,g)-1;if(b.type===s&&1<n-b.size)for(n-=1;n>b.size;)k=new r({type:s,size:n},k),n-=1;else if(b.type!==s&&1<n)for(n-=1;0<n;)k=new r({type:s,size:n},k),n-=1;b.addNode(k)}else if(b.type===s&&b.size>n)return c;break a}break;case "b_ul_item":if(n=
k.exec(w)){if(f&&s!==f)return c;"b_ul_block"===b.type?(k=new r({type:s,mark:n[1]},!0),y=c,this.lines[y]=m(g+2)+n[2],k.parentNode=b,c=this.tokenize(k,c,g+2)-1,this.lines[y]=m(g)+w,1<k.childNodes.length&&(b.complex=!0)):(k=new r({type:"b_ul_block"},!0),k.parentNode=b,c=this.tokenize(k,c,g,s)-1);b.addNode(k);break a}break;case "b_ol_item":if(n=k.exec(w)){if(f&&s!==f)return c;if("b_ol_block"===b.type){k=new r({type:s,mark:n[1]},!0);var y=n[1].length+2,q=c;this.lines[q]=m(g+y)+n[2];k.parentNode=b;c=this.tokenize(k,
c,g+y)-1;this.lines[q]=m(g)+w;1<k.childNodes.length&&(b.complex=!0)}else k=new r({type:"b_ol_block"},!0),k.parentNode=b,c=this.tokenize(k,c,g,s)-1;b.addNode(k);break a}break;case "b_lb_line":if(n=k.exec(w)){if(f&&s!==f)return c;"b_lb_block"===b.type?k=new r({type:s,text:a(n[1]||"")}):(k=new r({type:"b_lb_block"},!0),k.parentNode=b,c=this.tokenize(k,c,g,s)-1);b.addNode(k);break a}break;case "b_code":if(n=k.exec(w)){if(f&&s!==f)return c;k=new r({type:s,lang:n[1],"class":a(n[2])},!0);k.parentNode=b;
c=this.tokenize(k,c+1,g+3,"i_text")-1;k.text=k.getTextFromNodes("text","\n");k.childNodes=null;b.addNode(k);break a}break;case "b_oneliner":if(n=k.exec(w)){if(f&&s!==f)return c;k=new r({type:s,text:n[1]});b.addNode(k);break a}break;case "b_directive":if(n=k.exec(w)){if(f&&s!==f)return c;if(w=n[4]?"comment":n[1]||""){(y=this.getDirective(w))||e('Directive "'+w+'" does not exist.');if((this.isSameDirective(w,"header")||this.isSameDirective(w,"footer"))&&"b_section"===b.type)return c;k=new r({type:s,
row:c,indent:g,queue:y.queue,name:w,args:a(n[2]||""),text:a(n[3]||n[4]||"")},!0);"comment"===w&&n[4]&&(k.args="true",k.isImplicitComment=!0);c=this.tokenize(k,c+1,g+3,"i_text")-1;y=this.setupDirective(y,k);b.addNode(k);"immediate"===y.queue?this.executeDirective(y):this.scheduleDirective(y)}break a}break;case "b_paragraph":if(f&&s!==f)return c;k=new r({type:s,text:a(w)});b.addNode(k);break a;default:throw Error('Block element "'+s+'" does not have a handler.');}}}return c};l.prototype.setupDirective=
function(a,d){var c={};d.childNodes&&d.childNodes.length&&(c=b(d.getTextFromNodes("text","\n")));d.text&&c.normalText&&("comment"!==a.name||!d.isImplicitComment)&&e("Each directive can not have more than one body.");"comment"!==a.name?c.normalText?d.text=c.normalText:d.isOneliner=!0:d.text+=c.normalText?"\n"+c.normalText:"";d.opts=c.options||{};d.childNodes=null;return{queue:a.queue,action:a.action.bind(null),node:d}};l.prototype.getDirective=function(a){return this._directives[a]||null};l.prototype.isSameDirective=
function(a,b){return this._directives[a].action===this._directives[b].action};l.prototype.registerDirective=function(a,b,d){this._directives[b]={name:b,queue:a,action:d}};l.prototype.scheduleDirective=function(a){"before"===a.queue&&this.setupDirective(a,new r({type:"#directive"}));this._directiveQueues[a.queue].push(a)};l.prototype.executeDirective=function(a){if("string"===typeof a){a=this._directiveQueues[a];for(var b=0,d=a.length;b<d;b++)this.executeDirective(a[b])}else a.action(a.node,this.ast,
this._helpers)};j.exports=l},{"./class-inlinelexer.js":7,"./class-renderer.js":8,"./class-tnode.js":9,"./helpers.js":11,clone:13,extend:14}],7:[function(h,j){var f=h("./helpers.js").throwError,c=h("./helpers.js").trim,g=h("./class-tnode.js"),b=function(b){this.options=b;this._markers={i_bold:["{*","*}"],i_italic:["{/","/}"],i_standout:["{%","%}"],i_code:["{`","`}"],i_keystroke:["{:",":}"],i_literal:["``","``"],i_link:["[[","]]"],i_raw:["{{","}}"],i_role:["{~","~}"],i_note:["{[","]}"],i_anchor:["{#",
"#}"],i_pipe:["{|","|}"]};this._markerNames="i_bold i_italic i_standout i_code i_keystroke i_literal i_link i_raw i_role i_note i_anchor i_pipe".split(" ")};b.lex=function(c,d){return(new b(d)).lex(c)};b.prototype.lex=function(b){if(!b.childNodes&&"text"in b){b.childNodes=[];for(var d=this._markers,a=this._markerNames,m=b.text||"",r="";m;){var l=1,t=0,x=a.length;a:for(;t<x;t++){var v=a[t],h=d[v],j=h[0].length;if(m.substr(0,j)===h[0])switch(l=m.indexOf(h[1],j),0>l&&f('Inline markup "'+h[0]+'" without "'+
h[1]+'".'),j=m.substring(j,l),r&&(b.addNode(new g({type:"i_text",text:r})),r=""),l=h[0].length+j.length+h[1].length,v){case "i_bold":case "i_italic":case "i_standout":case "i_literal":b.addNode(new g({type:v,text:c(j)}));break a;case "i_code":case "i_keystroke":case "i_raw":b.addNode(new g({type:v,text:j}));break a;case "i_link":h=/^(.*?)(?:\|(.*))?$/.exec(j);b.addNode(new g({type:v,text:c(h[1]),link:c(h[2]||"")}));break a;case "i_role":h=j.indexOf("~");b.addNode(new g({type:v,name:0>h?"general":
c(j.substr(0,h)),text:0>h?j:j.substr(h+1)}));break a;case "i_note":case "i_anchor":case "i_pipe":b.addNode(new g({type:v,name:c(j)}));break a;default:throw Error('Span element "'+v+'" does not have a handler.');}}if(1===l){for(v=0;" "===m[v];v++);if(0<v)b.addNode(new g({type:"i_text",text:" "})),r="",m=m.substr(v);else if(r+=m[0],m=m.substr(1),!m||" "===m[0])b.addNode(new g({type:"i_text",text:r})),r=""}else m=m.substr(l)}b.text||b.addNode(new g({type:"i_text",text:""}));delete b.text}};j.exports=
b},{"./class-tnode.js":9,"./helpers.js":11}],8:[function(h,j){var f=h("clone"),c=h("extend"),g=h("./helpers.js"),b=g.mergeClasses,e=g.trim,d=function(a){var b=h("./class-tnode.js"),e=h("./class-blocklexer.js"),l=h("./class-inlinelexer.js");this.options=a;this._helpers=c(f(g,!1),{clone:f,extend:c,options:this.options,renderer:this,Tnode:b,InlineLexer:l,BlockLexer:e,Renderer:d})};d.escape=function(a){return a?a.replace(/["'&<>]/g,function(a){switch(a){case '"':return"&quot;";case "'":return"&#39;";
case "&":return"&amp;";case "<":return"&lt;";case ">":return"&gt;";default:return a}}):""};d.getAttrId=function(a){return a?' id="'+d.escape(a)+'"':""};d.getAttrAny=function(a,b){Array.isArray(b)&&(b=b.filter(function(a){return a&&e(a)}),"class"===a&&(b=b.map(function(a){return a.replace(/[ \t\f]+/g,"-")})),b=b.join(" "));return b?" "+a+'="'+d.escape(b)+'"':""};d.getElement=function(a,b,c,e,g,f){"object"!==typeof b&&(f=g,g=e,e=c,c=b,b={});var h="<"+a,j;for(j in b)h="id"===j?h+d.getAttrId(b[j]):h+
d.getAttrAny(j,b[j]);h+=">";e||(c=c||"",h+=(f?"\n":"")+(g?c:d.escape(c))+(f?"\n":"")+"</"+a+">");return h};d.getBlock=function(a,b,c,e,g){return d.getElement(a,b,c,e,g,!0)};d.getSpan=function(a,b,c,e,g){return d.getElement(a,b,c,e,g,!1)};d.render=function(a,b){return(new d(b)).render(a)};d.prototype.render=function(a){this._ast=a;var b="",c=this;a.traverse(function(a){var e;switch(a.type.substr(0,2)){case "b_":e=c[a.type](a,c._ast,c._helpers);a.parentNode._html=a.parentNode._html?a.parentNode._html+
"\n"+e:e;delete a._html;break;case "i_":e=c[a.type](a,c._ast,c._helpers);a.parentNode._html=(a.parentNode._html||"")+e;delete a._html;break;default:if(/^[a-z][a-z]*$/.test(a.type)){e={};for(var g=Object.keys(a),f=0,h=g.length;f<h;f++){var j=g[f];"$"===j.charAt(0)&&(e[j.substr(1)]=a[j])}f=(g=!a.isSpan)?"getBlock":"getSpan";e=a.text?d[f](a.type,e,a.text||"",a.isClosed,!1):d[f](a.type,e,a._html||"",a.isClosed,!0);if(!a.parentNode)return b=(g?"\n":"")+e,!1;a.parentNode._html=(a.parentNode._html||"")+
(a.parentNode._html&&g?"\n":"")+e}else if("_fragment_"===a.type){e=a._html||"";if(!a.parentNode)return b=e,!1;a.parentNode._html=(a.parentNode._html||"")+e}else b="_root_"===a.type?(a._html||"").replace(/^\n+|\n+$/g,""):a._html||"";delete a._html}});return b};d.prototype.b_section=function(a){return d.getBlock(1===a.size?"div":"section",{id:a.$id||a.id,"class":b("kaj-section",a.$class),style:a.$style,title:a.$title},a._html||"",!1,!0)};d.prototype.b_heading=function(a){var c=a.link?d.getSpan("a",
{href:encodeURI(a.link)},a.text||""):d.getSpan("span",a.text||"");return d.getSpan(7>a.size?"h"+a.size:"p",{id:a.$id,"class":b("kaj-title",a.$class),style:a.$style,title:a.$title},c,!1,!0)};d.prototype.b_ul_item=function(a){var c="";switch(a.mark){case "*":c="kaj-item-x";break;case "+":c="kaj-item-y";break;case "-":c="kaj-item-z"}return d.getSpan("li",{id:a.$id,"class":b(c,a.$class),style:a.$style,title:a.$title},a._html||"",!1,!0)};d.prototype.b_ul_block=function(a){return d.getBlock("ul",{id:a.$id,
"class":a.$class,style:a.$style,title:a.$title},a._html||"",!1,!0)};d.prototype.b_ol_item=function(a){return d.getSpan("li",{id:a.$id,"class":a.$class,style:a.$style,title:a.$title},a._html||"",!1,!0)};d.prototype.b_ol_block=function(a){return d.getBlock("ol",{id:a.$id,"class":a.$class,style:a.$style,title:a.$title},a._html||"",!1,!0)};d.prototype.b_lb_line=function(a){return d.getSpan("div",{id:a.$id,"class":b("kaj-line",a.$class),style:a.$style,title:a.$title},a._html?a._html:d.getSpan("br","",
!0),!1,!0)};d.prototype.b_lb_block=function(a){return d.getBlock("div",{id:a.$id,"class":b("kaj-line-block",a.$class),style:a.$style,title:a.$title},a._html||"",!1,!0)};d.prototype.b_code=function(a){var c,e=this.options.highlight;e&&(c=e(a.text,a.lang));return d.getBlock("pre",{id:a.$id,"class":b(a.lang&&"lang-"+a.lang,a.class,a.$class),style:a.$style,title:a.$title},c?c:a.text,!1,!!c)};d.prototype.b_oneliner=function(a){var c,e=this.options.highlight;e&&(c=e(a.text,a.lang));return d.getSpan("pre",
{id:a.$id,"class":b("kaj-oneliner",a.$class),style:a.$style,title:a.$title},c?c:a.text,!1,!!c)};d.prototype.b_paragraph=function(a){return("b_ul_item"===a.parentNode.type||"b_ol_item"===a.parentNode.type)&&!a.parentNode.parentNode.complex?a._html||"":d.getSpan("p",{id:a.$id,"class":a.$class,style:a.$style,title:a.$title},a._html||"",!1,!0)};d.prototype.b_indented=function(a){return d.getBlock("blockquote",{id:a.$id,"class":b("kaj-indented",a.$class),style:a.$style,title:a.$title},a._html||"",!1,!0)};
d.prototype.b_raw=function(a){return a.text?a.text:""};d.prototype.i_raw=function(a){return a.text||""};d.prototype.i_text=function(a){return d.escape(a.text)};d.prototype.i_bold=function(a){return d.getSpan("b",{id:a.$id,"class":a.$class,style:a.$style,title:a.$title},a.text)};d.prototype.i_italic=function(a){return d.getSpan("i",{id:a.$id,"class":a.$class,style:a.$style,title:a.$title},a.text)};d.prototype.i_standout=function(a){return d.getSpan("b",{id:a.$id,"class":a.$class,style:a.$style,title:a.$title},
d.getSpan("i",a.text),!1,!0)};d.prototype.i_code=function(a){return d.getSpan("code",{id:a.$id,"class":a.$class,style:a.$style,title:a.$title},a.text)};d.prototype.i_keystroke=function(a){return d.getSpan("kbd",{id:a.$id,"class":a.$class,style:a.$style,title:a.$title},a.text)};d.prototype.i_literal=function(a){return d.getSpan("span",{id:a.$id,"class":b("kaj-inline-literal",a.$class),style:a.$style,title:a.$title},a.text)};d.prototype.i_link=function(a){if(a.link){var c;if(c=/^=(\d\d*(?:\.\d\d*)*)=$/.exec(a.link))a.link=
"#kaj-section-"+c[1].replace(/\./g,"-");else if(c=/^#(.+)#$/.exec(a.link))a.link="#kaj-anchor-def-"+c[1];else if(c=/^~(.+)~$/.exec(a.link))a.link=/^\d\d*$/.test(c[1])?"#kaj-note-def-"+c[1]:"#kaj-cite-def-"+c[1]}else a.link=a.text;return d.getSpan("a",{id:a.$id,"class":b("kaj-link-"+("#"===a.link[0]?"internal":"external"),a.link===a.text?"kaj-link-raw":null,a.$class),style:a.$style,title:a.$title,href:encodeURI(a.link)},a.text)};d.prototype.i_anchor=function(a){return!a.name?"":d.getSpan("span",{id:a.$id||
"kaj-anchor-def-"+a.name,"class":b("kaj-anchor-def",a.$class),style:a.$style,title:a.$title},"")};d.prototype.i_pipe=function(a){return!a.name?"":d.getSpan("span",{id:a.$id,"class":b("kaj-pipe",a.$class),style:a.$style,title:a.$title},a.name)};d.prototype.i_note=function(a){return!a.name?"":/^\d\d*$/.test(a.name)?d.getSpan("a",{id:a.$id,"class":b("kaj-note-ref",a.$class),style:a.$style,title:a.$title,href:"#kaj-note-def-"+a.name},d.getSpan("sup",a.name),!1,!0):d.getSpan("a",{id:a.$id,"class":b("kaj-cite-ref",
a.$class),style:a.$style,title:a.$title,href:"#kaj-cite-def-"+encodeURI(a.name)},a.name)};d.prototype.i_role=function(a){if(/^[ \t\f]*$/.test(a.name||""))return"";var c=this.options.roles;return c[a.name]?c[a.name](a,this._ast,this._helpers):d.getSpan("span",{id:a.$id,"class":b("kaj-role-"+a.name,a.$class),style:a.$style,title:a.$title},a.text)};j.exports=d},{"./class-blocklexer.js":6,"./class-inlinelexer.js":7,"./class-tnode.js":9,"./helpers.js":11,clone:13,extend:14}],9:[function(h,j){var f=h("./helpers.js").rtrimTextBlock,
c=function(g,b){this.id=this.class=this.style="";for(var e=Object.keys(g),d=0,a=e.length;d<a;d++){var f=e[d];void 0!==g[f]&&(this[f]=g[f])}this.text=this.text||"";this.$id=this.$id||"";this.$title=this.$title||"";this.$style=this.$style||"";this.$class=this.$class||"";this.childNodes=b?[]:null;b instanceof c?this.addNode(b):Array.isArray(b)&&this.addNodes(b);this.parentNode=null};c.prototype.addNode=function(c){this.childNodes.push(c);c.parentNode=this};c.prototype.addNodes=function(c){for(var b=
0,e=c.length;b<e;b++)this.addNode(c[b])};c.prototype.replaceNode=function(c,b){var e=this.childNodes.indexOf(c);0<=e&&(Array.isArray(b)?(this.insertNode(e,b),c.parentNode.removeNode(c)):(this.childNodes[e]=b,b.parentNode=this),c.parentNode=null)};c.prototype.insertNode=function(c,b){if(Array.isArray(b)){this.childNodes.splice.apply(this.childNodes,[c,0].concat(b));for(var e=0,d=b.length;e<d;e++)b[e].parentNode=this}else this.childNodes.splice(c,0,b),b.parentNode=this};c.prototype.getNthNode=function(c){return this.childNodes[c-
1]||null};c.prototype.getTextFromNodes=function(c,b){for(var e=this.childNodes||[],d=e.length,a=[],m=0;m<d;m++)a.push(e[m][c]||"");return f(a.join(b))};c.prototype.removeNode=function(c){var b=this.childNodes.indexOf(c);0<=b&&this.childNodes.splice(b,1);c.parentNode=null};c.prototype.remove=function(){this.parentNode.removeNode(this)};c.prototype.replace=function(c){this.parentNode.replaceNode(this,c)};c.prototype.traverse=function(c,b){if(b){var e=c(this);if(!0===e||!1===e)return e;if(this.childNodes){e=
[];d=this.childNodes;do{a=0;f=d.length;a:for(;a<f;a++)if(d[a]){switch(c(d[a])){case !1:return!1;case !0:continue a}d[a].childNodes&&(e=e.concat(d[a].childNodes))}d=e;e=[]}while(d.length)}}else{if(this.childNodes){var d=this.childNodes,a=0,f=d.length;a:for(;a<f;a++)if(d[a])switch(d[a].traverse(c,b)){case !1:return!1;case !0:break a}}return c(this)}};j.exports=c},{"./helpers.js":11}],10:[function(h,j){j.exports={before:{"#section":function(f,c){var g=function(b){if(b!==this.root){if("b_section"!==b.type)return!0;
if(6<b.size)return!1;var c=b.size,d=this.counters;c>d.length&&(d[c-1]=0);d[c-1]+=1;var a=d.slice(0,c).join("-");b.id="kaj-section-"+a;b.childNodes&&6>c&&b.traverse(g.bind({root:b,counters:d.slice(0,c)}),!0);return!0}};c.traverse(g.bind({root:c,counters:[]}),!0)},role:function(f,c,g){f.parentNode.removeNode(f);c=f.args;(!c||/^[ \t\f~]|[ \t\f~]$/.test(c))&&g.throwError('Directive "role": invalid role name');var b=f.opts,e=b.wrapper||"span";/^!--|[<>\/?\x00]/.test(e)&&g.throwError('Directive "role": invalid value for option "wrapper"');
var d=b.class;d&&(d=d.split(/[ \t\f]+/));g.options.roles[c]=function(a,c,f){return f.Renderer.getSpan(e,{id:b.id||a.$id,"class":f.mergeClasses(d,a.$class),style:(b.style?b.style+";":"")+a.$style,title:b.title||a.$title},a.text)}}},immediate:{"@":function(f,c){var g=f.args,b=f.opts;if(g){g="#"+g;c[g]={};for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(c[g][e]=b[e])}f.parentNode.removeNode(f)},raw:function(f,c,g){"html"===f.args?f.parentNode.replaceNode(f,new g.Tnode({type:"b_raw",text:g.ltrimTextBlock(f.text)})):
f.parentNode.removeNode(f)},comment:function(f,c,g){"true"===f.args?(c=g.ltrimTextBlock,f.parentNode.replaceNode(f,new g.Tnode({type:"b_raw",text:c(f.text).split("\n").map(function(b,c){b=b.replace(/--\x3e/g,"- ->");return 0<c?b?"     "+b:"":"\x3c!-- "+b}).join("\n")+" --\x3e"}))):f.parentNode.removeNode(f)},alias:function(f,c,g){f.parentNode.removeNode(f);f.isOneliner||g.throwError('Directive "alias": invalid syntax');var b=f.text;(!b||/^[# \t\f~]|[ \t\f~]$/.test(b))&&g.throwError('Directive "alias": invalid old name');
c=f.opts.to;(!c||/^[# \t\f]|[ \t\f]$/.test(c)||/[{}]/.test(c))&&g.throwError('Directive "alias": invalid new name');f=f.args;"role"===f?(g=g.options.roles,g[c]=g[b]):"directive"===f&&(f=g.options.directives,f.before[b]?(b=f.before[c]=f.before[b],g.blockLexer.registerDirective("before",c,b)):f.immediate[b]?(b=f.immediate[c]=f.immediate[b],g.blockLexer.registerDirective("immediate",c,b)):f.after[b]&&(b=g.options.directives.after[c]=f.after[b],g.blockLexer.registerDirective("after",c,b)))},"class":function(f,
c,g){var b=g.Tnode;c=f.opts;var e=c.class||f.args,d=f.row+Object.keys(f.opts).length+1,a=f.indent+3,m=f.parentNode;e&&(e=e.split(/[ \t\f]+/));if(f.isOneliner)f.text=g.ltrimTextBlock(f.text),b=new b({type:"div",isSpan:!0,$id:c.id,$class:e,$style:c.style,$title:c.title},new b({type:"_fragment_",text:f.text})),m.replaceNode(f,b);else{b=new b({type:""},!0);b.parentNode=m;g.blockLexer.tokenize(b,d,a);d=b.childNodes;a=0;for(b=d.length;a<b;a++)e&&(d[a].$class=d[a].$class?g.mergeClasses(d[a].$class,e):e),
c.id&&(d[a].$id=c.id,c.id=null),c.style&&(d[a].$style+=(d[a].$style?";":"")+c.style),c.title&&(d[a].$title=c.title);m.replaceNode(f,d)}},block:function(f,c,g){c=g.Tnode;var b=f.opts,e=b.class||f.args;e&&(e=e.split(/[ \t\f]+/));e=new c({type:"div",$id:b.id,$class:e,$style:b.style,$title:b.title},!0);f.isOneliner?(f.text=g.ltrimTextBlock(f.text),e.isSpan=!0,e.addNode(new c({type:"_fragment_",text:f.text}))):(e.parentNode=f.parentNode,g.blockLexer.tokenize(e,f.row+Object.keys(b).length+1,f.indent+3));
f.parentNode.replaceNode(f,e)},header:function(f,c,g){c=g.Tnode;var b=f.opts,e=b.class;e&&(e=e.split(/[ \t\f]+/));e=new c({type:"header",$id:b.id,$class:e,$style:b.style,$title:b.title},!0);f.isOneliner?(f.text=g.ltrimTextBlock(f.text),f.text?(e.isSpan=!0,e.addNode(new c({type:"_fragment_",text:f.text})),f.parentNode.replaceNode(f,e)):f.parentNode.removeNode(f)):(e.parentNode=f.parentNode,g.blockLexer.tokenize(e,f.row+Object.keys(b).length+1,f.indent+3),f.parentNode.replaceNode(f,e))},footer:function(f,
c,g){c=g.Tnode;var b=f.opts,e=b.class;e&&(e=e.split(/[ \t\f]+/));e=new c({type:"footer",$id:b.id,$class:e,$style:b.style,$title:b.title},!0);f.isOneliner?f.text?(f.text=g.ltrimTextBlock(f.text),e.isSpan=!0,e.addNode(new c({type:"_fragment_",text:f.text})),f.parentNode.replaceNode(f,e)):f.parentNode.removeNode(f):(e.parentNode=f.parentNode,g.blockLexer.tokenize(e,f.row+Object.keys(b).length+1,f.indent+3),f.parentNode.replaceNode(f,e))},image:function(f,c,g){c=g.Tnode;var b=g.mergeClasses,e=f.args.replace(/[ \t\f]+/g,
"-"),d=g.ltrimTextBlock(f.text);g=f.opts;var a=g.class;a&&(a=a.split(/[ \t\f]+/));g.id=g.id||"";g.class=g.class||"";g.style=g.style||"";g.title=g.title||"";g.caption=g.caption||"";var m="true"===g.simple,a=e?b("kaj-image-"+e,a):a,b=new c({type:"img",isClosed:!0,$id:m?g.id:"",$class:m?a:"",$style:g.style,$title:m?g.title:"",$alt:g.alt},!1),e=encodeURI(d.split(/  */,1)[0]),d=/ /.test(d)&&d.split(/ *,  */).map(function(a){a=a.split(/  */);a[0]=encodeURI(a[0]);return a.join(" ")}).join(", "),h,l;"true"!==
g.lazyload?(h="$src",l="$srcset"):(h="$data-src",l="$data-srcset");b[h]=e;b[l]=d;g.link&&(b=new c({type:"a",isSpan:!0,$href:encodeURI(g.link)},b));m||(b=new c({type:"figure",$id:g.id,$class:a,$title:g.title},b),g.caption&&b.addNode(new c({type:"figcaption",isSpan:!0},new c({type:"_fragment_",text:g.caption}))));f.parentNode.replaceNode(f,b)},note:function(f,c,g){if(c=f.args){var b=g.Tnode,e=g.ltrimTextBlock(f.text),d=f.opts,a=d.class;a&&(a=a.split(/[ \t\f]+/));var m=!/^\d\d*$/.test(c),h=new b({type:"_fragment_"},
!0);f.isOneliner?(h.text=e,h.childNodes=null):(h.parentNode=f.parentNode,g.blockLexer.tokenize(h,f.row+Object.keys(d).length+1,f.indent+3));h=new b({type:"tr"},[new b({type:"td",isSpan:!0,$class:"kaj-label",text:"["+c+"]"}),new b({type:"td",isSpan:f.isOneliner},h)]);h=new b({type:"table",$class:g.mergeClasses("kaj-"+(m?"cite-def":"note-def"),a),$id:d.id||"kaj-"+(m?"cite-def-":"note-def-")+encodeURI(c)},h);f.parentNode.replaceNode(f,h)}else f.parentNode.removeNode(f)},"csv-table":function(f,c,g){c=
g.Tnode;var b=g.ltrimTextBlock,e=f.args,d=f.opts,a=d.class;a&&(a=a.split(/[ \t\f]+/));var h=(d.header||"").split(/[ \t]+/,2).map(function(a){return"true"===a}),r=d.delimiter||",",l=d.linebreak||!1,b=b(f.text).split("\n").map(function(a){return a.split(r)}).filter(function(a){return a.length}),e=new c({type:"table",$id:d.id,$class:a,$style:d.style,$title:d.title},e?new c({type:"caption",isSpan:!0,text:e}):!0);l&&(l=RegExp("[ \\t]*"+l.replace(/([.\\+*?\^\[\]$(){}])/g,"\\$1")+"[ \\t]*","g"));if(h[0]){var j=
!1;if(d=b.shift())for(var j=new c({type:"tr"},!0),a=0,x=d.length;a<x;a++)text=g.trim(d[a]),l&&(text=text.replace(l,"{{<br>}}")),j.addNode(new c({type:"th",isSpan:!0},new c({type:"_fragment_",text:text})));e.addNode(new c({type:"thead"},j))}j=new c({type:"tbody"},!0);a=0;for(x=b.length;a<x;a++){for(var d=b[a],v=new c({type:"tr"},!0),u=0,z=d.length;u<z;u++)text=g.trim(d[u]),l&&(text=text.replace(l,"{{<br>}}")),v.addNode(new c({type:0===u&&h[1]?"th":"td",isSpan:!0},new c({type:"_fragment_",text:text})));
j.addNode(v)}e.addNode(j);f.parentNode.replaceNode(f,e)}},after:{link:function(f,c,g){f.parentNode.removeNode(f);f.text=g.ltrimTextBlock(f.text);var b=f.args.toLowerCase(),e=f.text;if(e&&b){var d=f.opts;c.traverse(function(a){if("i_link"===a.type){if(a.link){var c=/^\{(.+)\}$/.exec(a.link);if(!c||c[1].toLowerCase()!==b)return}else if(a.text.toLowerCase()!==b)return;a.link=e;d.id&&(a.$id=d.id,d.id=null);d.class&&((c=d.class)&&(c=c.split(/[ \t\f]+/)),a.$class=a.$class?g.mergeClasses(a.$class,c):c);
d.style&&(a.$style+=(a.$style?";":"")+d.style);d.title&&(nodes.$title=d.title)}})}},"pipe-image":function(f,c,g){f.parentNode.removeNode(f);var b=f.args,e=g.ltrimTextBlock(f.text);if(b&&e){var d=f.opts;d.simple="true";c.traverse(function(a){"i_pipe"!==a.type||a.name!==b||(a.args=d.format||"",a.opts=d,a.text=e,g.options.directives.immediate.image(a,c,g))})}},"pipe-abbr":function(f,c,g){f.parentNode.removeNode(f);var b=f.args,e=g.ltrimTextBlock(f.text);if(b&&e){var d=f.opts,a=d.class;a&&(a=a.split(/[ \t\f]+/));
c.traverse(function(c){if(!("i_pipe"!==c.type||c.name!==b)){var f=new g.Tnode({type:"abbr",isSpan:!0,text:b,$title:d.title||e,$id:d.id,$class:a,$style:d.style});c.parentNode.replaceNode(c,f)}})}},"pipe-text":function(f,c,g){f.parentNode.removeNode(f);var b=f.args,e=g.ltrimTextBlock(f.text);if(b&&e){var d="raw"===f.opts.format?"i_raw":"i_text";c.traverse(function(a){if(!("i_pipe"!==a.type||a.name!==b)){var c=new g.Tnode({type:d,text:e});a.parentNode.replaceNode(a,c)}})}},contents:function(f,c,g){var b=
g.Tnode;g=f.args;var e=f.opts,d=e.class;d&&(d=d.split(/[ \t\f]+/));var a=parseInt(e.depth,10),a=1<=a&&6>=a?a:3,e=new b({type:"div",$id:e.id||"kaj-contents",$class:d,$style:e.style,$title:e.title},!0);g&&e.addNode(new b({type:"div",$class:"kaj-contents-title"},new b({type:"span",isSpan:!0,text:g})));var h=new b({type:"ul"},!0);c.traverse(function(d){if(d!==c){if("b_section"!==d.type)return!0;if(d.size>a)return!1;if(!d.id)return!0;var e=d.size,f=d.getNthNode(1);"b_heading"!==f.type&&(f={});f.link="#kaj-contents";
var e=d.id.replace(/^kaj-section-/,"").split("-",e).map(function(a){return parseInt(a,10)}),g=h.getNthNode(e[0]);g||(g=new b({type:"li"},new b({type:"a",isSpan:!0,$href:"#"+d.id,text:f.text})),h.addNode(g));for(var j,u=1,z=e.length;u<z;u++){if(!(j=g.getNthNode(2)))j=new b({type:"ul"},!0),g.addNode(j);g=j;if(!(j=g.getNthNode(e[u])))j=new b({type:"li"},new b({type:"a",isSpan:!0,$href:"#"+d.id,text:f.text})),g.addNode(j);g=j}}},!0);h.childNodes.length?(e.addNode(h),f.parentNode.replaceNode(f,e)):f.parentNode.removeNode(f)}}}},
{}],11:[function(h,j){var f=function(c){return c.replace(/^[ \t\f]+|[ \t\f]+$/g,"")};j.exports={throwError:function(c){throw Error("SyntaxError: "+c+"\n");},trim:f,ltrimTextBlock:function(c){return c.replace(/^(?: *\n)+/,"")},rtrimTextBlock:function(c){return c.replace(/(?:\n *)+$/,"")},parseOptions:function(c){var g={};c=c.split("\n");for(var b=0,e;e=c[b];b++){var d=/^:([^:][^:]*):(.*)$/.exec(e);if(!d)break;e=d[1];d=f(d[2]);g[e]=d}return{options:g,optionText:c.slice(0,b).join("\n"),normalText:c.slice(b).join("\n")}},
mergeClasses:function(){for(var c=[].slice.call(arguments),f=[],b=0,e=c.length;b<e;b++)f=f.concat(c[b]);return f},getIndent:function(c){c=c.search(/[^ ]/);return 0>c?!1:c},pad:function(c){for(var f="",b="";0<c;)b+=b||" ",1===(c&1)&&(f+=b),c>>>=1;return f}}},{}],12:[function(h,j){j.exports={general:function(f,c,g){return g.Renderer.getSpan("span",{id:f.$id,"class":g.mergeClasses("kaj-general",f.$class),style:f.$style,title:f.$title},g.trim(f.text))}}},{}],13:[function(h,j){var f=h("buffer").Buffer,
c=function(b,c,d,a){function h(b,d){if(null===b)return null;if(0==d)return b;var u,z;if("object"!=typeof b)return b;if(g.isArray(b))u=[];else if(g.isRegExp(b))u=RegExp(b.source,g.getRegExpFlags(b)),b.lastIndex&&(u.lastIndex=b.lastIndex);else if(g.isDate(b))u=new Date(b.getTime());else{if(t&&f.isBuffer(b))return u=new f(b.length),b.copy(u),u;"undefined"==typeof a?(z=Object.getPrototypeOf(b),u=Object.create(z)):(u=Object.create(a),z=a)}if(c){var A=j.indexOf(b);if(-1!=A)return l[A];j.push(b);l.push(u)}for(var k in b){var B;
z&&(B=Object.getOwnPropertyDescriptor(z,k));B&&null==B.set||(u[k]=h(b[k],d-1))}return u}var j=[],l=[],t="undefined"!=typeof f;"undefined"==typeof c&&(c=!0);"undefined"==typeof d&&(d=Infinity);return h(b,d)},g={isArray:function(b){return Array.isArray(b)||"object"===typeof b&&"[object Array]"===Object.prototype.toString.call(b)},isDate:function(b){return"object"===typeof b&&"[object Date]"===Object.prototype.toString.call(b)},isRegExp:function(b){return"object"===typeof b&&"[object RegExp]"===Object.prototype.toString.call(b)},
getRegExpFlags:function(b){var c="";b.global&&(c+="g");b.ignoreCase&&(c+="i");b.multiline&&(c+="m");return c}};"object"===typeof j&&(j.exports=c);c.clonePrototype=function(b){if(null===b)return null;var c=function(){};c.prototype=b;return new c}},{buffer:1}],14:[function(h,j){var f=Object.prototype.hasOwnProperty,c=Object.prototype.toString,g=function(b){if(!b||"[object Object]"!==c.call(b))return!1;var e=f.call(b,"constructor"),d=b.constructor&&b.constructor.prototype&&f.call(b.constructor.prototype,
"isPrototypeOf");if(b.constructor&&!e&&!d)return!1;for(var a in b);return void 0===a||f.call(b,a)};j.exports=function e(){var c,a,f,h,j,t=arguments[0],x=1,v=arguments.length,u=!1;if("boolean"===typeof t)u=t,t=arguments[1]||{},x=2;else if("object"!==typeof t&&"function"!==typeof t||null==t)t={};for(;x<v;++x)if(c=arguments[x],null!=c)for(a in c)f=t[a],h=c[a],t!==h&&(u&&h&&(g(h)||(j=Array.isArray(h)))?(j?(j=!1,f=f&&Array.isArray(f)?f:[]):f=f&&g(f)?f:{},t[a]=e(u,f,h)):void 0!==h&&(t[a]=h));return t}},
{}]},{},[5]);
